<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–æ–≤–æ—Å—Ç–∏ –ú–æ—Å–∫–≤–∞ ‚Ä¢ –ú–µ–≥–∞–ø–æ–ª–∏—Å</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background: linear-gradient(145deg, #d9e6f2 0%, #f2f8ff 100%);
            min-height: 100vh;
            padding: 30px 25px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 30%, rgba(255, 220, 150, 0.2) 0%, transparent 40%),
                        radial-gradient(circle at 90% 70%, rgba(150, 200, 255, 0.25) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .app {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            border-radius: 70px;
            box-shadow: 0 50px 90px -30px #102b40, 0 0 0 2px rgba(255, 255, 255, 0.8) inset;
            padding: 50px 55px;
            position: relative;
            z-index: 10;
            border: 1px solid rgba(255, 255, 255, 0.9);
        }

        .header {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 45px;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 120px;
            padding: 16px 30px 16px 45px;
            box-shadow: 0 20px 40px -12px #1a3a52, 0 2px 0 0 rgba(255,255,255,0.8) inset;
            border: 1px solid rgba(255,255,255,0.8);
        }

        .logo h1 {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(145deg, #00263b, #1f5680);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.02em;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo h1::after {
            content: '‚òÖ';
            font-size: 3rem;
            -webkit-text-fill-color: #c9a03d;
            color: #c9a03d;
            text-shadow: 0 5px 10px #926d24;
        }

        .badge {
            background: #204967;
            color: white;
            padding: 10px 28px;
            border-radius: 60px;
            font-weight: 600;
            font-size: 1.2rem;
            box-shadow: inset 0 -4px 0 #0e293f;
            border: 1px solid #8bb3d1;
        }

        .action-buttons {
            display: flex;
            gap: 20px;
        }

        .btn {
            border: none;
            padding: 20px 48px;
            border-radius: 70px;
            font-weight: 700;
            font-size: 1.3rem;
            background: rgba(255, 255, 255, 0.9);
            color: #021e30;
            backdrop-filter: blur(5px);
            box-shadow: 0 25px 35px -15px #021e32, 0 3px 0 0 white inset;
            cursor: pointer;
            transition: 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            border: 2px solid white;
        }

        .btn-primary {
            background: #11314a;
            color: white;
            box-shadow: 0 30px 40px -15px #001b2d, 0 3px 0 0 #6c93b5 inset;
        }

        .btn-primary:hover {
            background: #1a405e;
            transform: scale(1.02) translateY(-2px);
        }

        .btn-outline:hover {
            background: white;
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(420px, 1fr));
            gap: 40px;
            margin: 50px 0 45px;
        }

        .news-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 60px;
            overflow: hidden;
            box-shadow: 0 30px 45px -20px #12314a, 0 0 0 2px rgba(255, 255, 255, 0.9) inset;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            border: 2px solid rgba(255, 255, 255, 0.9);
            position: relative;
        }

        .news-card:hover {
            transform: translateY(-12px) scale(1.01);
            box-shadow: 0 45px 60px -20px #03273f, 0 0 0 4px white inset;
            background: rgba(255, 255, 255, 0.95);
        }

        .delete-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #c0392b;
            color: white;
            border: 3px solid white;
            font-size: 2rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 20;
            box-shadow: 0 5px 15px #3d1e1e;
            transition: 0.2s;
            line-height: 1;
            display: none;
        }

        .delete-btn:hover {
            background: #e74c3c;
            transform: scale(1.1);
        }

        .delete-btn.visible {
            display: flex;
        }

        .card-img {
            width: 100%;
            height: 260px;
            object-fit: cover;
            border-bottom: 4px solid white;
            pointer-events: none;
        }

        .card-content {
            padding: 30px 28px 25px;
            pointer-events: none;
        }

        .card-title {
            font-weight: 800;
            font-size: 2rem;
            margin-bottom: 10px;
            color: #032a40;
            line-height: 1.2;
        }

        .card-excerpt {
            color: #1b4d6e;
            font-size: 1.2rem;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-weight: 500;
        }

        .detail-view {
            display: none;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            border-radius: 80px;
            padding: 60px;
            margin: 30px 0;
            box-shadow: 0 45px 70px -25px #00263b;
            border: 3px solid white;
        }

        .detail-view.show {
            display: block;
        }

        .detail-back {
            background: rgba(255, 255, 255, 0.8);
            border: 3px solid white;
            padding: 20px 45px;
            border-radius: 70px;
            font-weight: 700;
            color: #00263b;
            margin-bottom: 40px;
            cursor: pointer;
            font-size: 1.4rem;
            display: inline-flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 20px 30px -15px #021e32;
        }

        .detail-back:hover {
            background: white;
            gap: 22px;
        }

        .detail-content {
            max-width: 1100px;
            margin: 0 auto;
        }

        .detail-title {
            font-size: 4rem;
            font-weight: 800;
            color: #00263b;
            margin-bottom: 25px;
            background: linear-gradient(125deg, #002f4b, #216494);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .inline-image {
            max-width: 100%;
            border-radius: 60px;
            margin: 35px 0;
            box-shadow: 0 35px 50px -20px #032c44, 0 0 0 5px white, 0 0 0 8px #bed6ec;
            display: block;
        }

        .image-position-top {
            margin-top: 0;
            margin-bottom: 35px;
        }

        .image-position-middle {
            margin: 40px 0;
        }

        .image-position-bottom {
            margin-top: 35px;
            margin-bottom: 10px;
        }

        .detail-text-block {
            font-size: 1.6rem;
            line-height: 1.6;
            color: #0e334b;
            white-space: pre-wrap;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 70px;
            padding: 45px 50px;
            backdrop-filter: blur(2px);
            border: 2px solid rgba(255, 255, 255, 0.9);
            margin: 35px 0;
            font-weight: 500;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(12px);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(25px);
            max-width: 800px;
            width: 90%;
            padding: 55px;
            border-radius: 100px;
            box-shadow: 0 60px 90px -25px #021d33;
            border: 4px solid white;
        }

        .modal-card h2 {
            font-size: 2.8rem;
            color: #00263b;
            margin-bottom: 35px;
        }

        .input-group {
            margin-bottom: 30px;
        }

        .input-group label {
            font-weight: 700;
            color: #14466b;
            margin-bottom: 10px;
            display: block;
            font-size: 1.4rem;
        }

        .input-group input, .input-group textarea, .input-group select {
            width: 100%;
            padding: 22px 32px;
            border: 4px solid white;
            border-radius: 80px;
            font-size: 1.2rem;
            background: #ecf5fc;
            border: 3px solid #dae8f5;
        }

        .input-group input:focus, .input-group textarea:focus {
            border-color: #2d7eb3;
            background: white;
        }

        .photo-upload-panel {
            background: #deecf9;
            border-radius: 80px;
            padding: 35px;
            border: 4px dashed white;
            margin: 25px 0;
        }

        .photo-item {
            background: white;
            border-radius: 90px;
            padding: 20px 25px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .photo-item input[type="file"] {
            flex: 2;
            min-width: 250px;
        }

        .photo-item select {
            flex: 1;
            min-width: 180px;
        }

        .remove-photo {
            background: #c0392b;
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 2rem;
            cursor: pointer;
        }

        .add-photo-btn {
            background: #1f5680;
            color: white;
            border: none;
            padding: 20px 38px;
            border-radius: 70px;
            font-weight: 700;
            font-size: 1.3rem;
            cursor: pointer;
            border-bottom: 6px solid #0d314a;
        }

        .modal-actions {
            display: flex;
            gap: 25px;
            margin-top: 40px;
        }

        .modal-actions button {
            flex: 1;
            padding: 22px;
            border-radius: 80px;
            font-weight: 700;
            font-size: 1.4rem;
            border: none;
            background: white;
            border-bottom: 6px solid #b3c9df;
            cursor: pointer;
        }

        .btn-publish {
            background: #03263b !important;
            color: white !important;
            border-bottom: 6px solid #153e5a !important;
        }

        .empty-news {
            text-align: center;
            padding: 90px;
            background: #e1effa;
            border-radius: 110px;
            font-size: 2rem;
            color: #01273f;
        }

        footer {
            margin-top: 60px;
            color: #1d3d57;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 500;
            background: rgba(255,255,255,0.4);
            padding: 25px 30px;
            border-radius: 100px;
            border: 2px solid rgba(255,255,255,0.9);
        }

        .game-disclaimer {
            font-size: 1.5rem;
            font-weight: 800;
            color: #832828;
            background: rgba(255, 255, 255, 0.7);
            padding: 15px 25px;
            border-radius: 70px;
            margin-bottom: 25px;
            display: inline-block;
            backdrop-filter: blur(5px);
            border: 2px solid #ffbaba;
        }
    </style>
</head>
<body>
<div class="app" id="app">
    <div class="header">
        <div class="logo">
            <h1>–ù–û–í–û–°–¢–ò –ú–û–°–ö–í–ê</h1>
            <span class="badge">#—Ü–µ–Ω—Ç—Ä —Å—Ç–æ–ª–∏—Ü—ã</span>
        </div>
        <div class="action-buttons">
            <button class="btn btn-outline" id="viewNewsBtn">üì∞ –°–º–æ—Ç—Ä–µ—Ç—å –Ω–æ–≤–æ—Å—Ç–∏</button>
            <button class="btn btn-primary" id="addNewsBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å</button>
        </div>
    </div>

    <div id="newsContainer" class="news-grid"></div>

    <div id="detailView" class="detail-view">
        <button class="detail-back" id="backToList">‚Üê –∫–æ –≤—Å–µ–º –Ω–æ–≤–æ—Å—Ç—è–º</button>
        <div class="detail-content" id="detailContent"></div>
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∞ –ø–∞—Ä–æ–ª—è -->
    <div id="passwordModal" class="modal">
        <div class="modal-card">
            <h2>üîê –î–æ—Å—Ç—É–ø —Ä–µ–¥–∞–∫—Ü–∏–∏</h2>
            <div class="input-group">
                <label>–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="passwordInput" placeholder="‚óè‚óè‚óè‚óè">
            </div>
            <div class="modal-actions">
                <button id="cancelPassword">–û—Ç–º–µ–Ω–∞</button>
                <button id="checkPasswordBtn" class="btn-publish">–í–æ–π—Ç–∏</button>
            </div>
            <p id="passwordError" style="color:#b52e2e; margin-top:20px; font-size:1.3rem;"></p>
        </div>
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–∏ -->
    <div id="addModal" class="modal">
        <div class="modal-card" style="max-width: 1000px;">
            <h2>üìù –ù–æ–≤–∞—è –º–æ—Å–∫–æ–≤—Å–∫–∞—è –Ω–æ–≤–æ—Å—Ç—å</h2>
            <div class="input-group">
                <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
                <input type="text" id="newsTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ">
            </div>
            <div class="input-group">
                <label>–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏)</label>
                <textarea id="newsExcerpt" rows="2" placeholder="–ö–æ—Ä–æ—Ç–∫–æ –æ —Å–æ–±—ã—Ç–∏–∏..."></textarea>
            </div>
            <div class="input-group">
                <label>–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏</label>
                <textarea id="newsFullText" rows="3" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏..."></textarea>
            </div>

            <div class="photo-upload-panel">
                <label style="font-size:1.6rem; font-weight:700;">üì∏ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (–¥–æ 5 —à—Ç, –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é)</label>
                <div id="photoList"></div>
                <button type="button" class="add-photo-btn" id="addPhotoBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</button>
            </div>

            <div class="modal-actions">
                <button id="cancelAddModal">–û—Ç–º–µ–Ω–∞</button>
                <button id="publishNewsBtn" class="btn-publish">üì¢ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è (–ø–∞—Ä–æ–ª—å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è) -->
    <div id="deletePasswordModal" class="modal">
        <div class="modal-card">
            <h2>üîê –£–¥–∞–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h2>
            <div class="input-group">
                <label>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</label>
                <input type="password" id="deletePasswordInput" placeholder="‚óè‚óè‚óè‚óè">
            </div>
            <div class="modal-actions">
                <button id="cancelDeletePassword">–û—Ç–º–µ–Ω–∞</button>
                <button id="checkDeletePasswordBtn" class="btn-publish">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
            <p id="deletePasswordError" style="color:#b52e2e; margin-top:20px; font-size:1.3rem;"></p>
        </div>
    </div>

    <!-- FOOTER –° –î–ò–°–ö–õ–ï–ô–ú–ï–†–û–ú –ü–†–û –ò–ì–†–£ –ò –ò–ö–û–ù–ö–ê–ú–ò -->
    <footer>
        <div class="game-disclaimer">‚ö†Ô∏è –í–°–ï –ù–û–í–û–°–¢–ò –Ø–í–õ–Ø–Æ–¢–°–Ø –í–´–ú–´–®–õ–ï–ù–ù–´–ú–ò –ò –û–¢–ù–û–°–Ø–¢–°–Ø –ö –í–ò–î–ï–û–ò–ì–†–ï ‚ö†Ô∏è</div>
        ¬© 2025 –ù–æ–≤–æ—Å—Ç–∏ –ú–æ—Å–∫–≤–∞ (–∏–≥—Ä–æ–≤–æ–π –ø—Ä–æ–µ–∫—Ç). –ù–µ –∏–º–µ–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ —Ä–µ–∞–ª—å–Ω—ã–º —Å–æ–±—ã—Ç–∏—è–º.

        <!-- –ë–õ–û–ö –° –ò–ö–û–ù–ö–ê–ú–ò -->
        <div style="margin-top: 30px; padding-top: 25px; border-top: 2px dashed rgba(255,255,255,0.5); display: flex; align-items: center; justify-content: center; gap: 20px; flex-wrap: wrap; font-size: 1.2rem;">
            <span style="display: flex; align-items: center; gap: 8px;">üïπÔ∏è <strong>–ù–µ –∏–≥—Ä–æ–≤–æ–π –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä</strong></span>
            <span style="color: #aaa;">|</span>
            <span style="display: flex; align-items: center; gap: 8px;">üéÆ <strong>–ß–∏—Å—Ç–æ –ø–æ –ø—Ä–∏–∫–æ–ª—É</strong></span>
            <span style="color: #aaa;">|</span>
            <span style="display: flex; align-items: center; gap: 8px;">üö´ <strong>–ù–∏–∫–∞–∫–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏</strong></span>
        </div>
    </footer>
</div>

<script>
    (function() {
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ ‚Äî –º–æ—Å–∫–æ–≤—Å–∫–∏–µ –Ω–æ–≤–æ—Å—Ç–∏
        let newsItems = [];

        try {
            const stored = localStorage.getItem('moscow_city_news');
            if (stored) {
                newsItems = JSON.parse(stored);
            } else {
                // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–æ –ú–æ—Å–∫–≤—É
                newsItems = [
                    {
                        id: 'msk1',
                        title: '–ù–æ–≤–∞—è —Å—Ç–∞–Ω—Ü–∏—è –º–µ—Ç—Ä–æ "–ù–∞–≥–∞—Ç–∏–Ω—Å–∫–∏–π –ó–∞—Ç–æ–Ω" –æ—Ç–∫—Ä—ã–ª–∞—Å—å',
                        excerpt: '–ü–∞—Å—Å–∞–∂–∏—Ä–æ–≤ –∂–¥—É—Ç –≤–∏—Ç—Ä–∞–∂–Ω—ã–µ –ø–æ—Ç–æ–ª–∫–∏ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ—Å—Ç–∏–±—é–ª–∏.',
                        fullText: '–°—Ç–∞–Ω—Ü–∏—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –Ω–∞ –ó–∞–º–æ—Å–∫–≤–æ—Ä–µ—Ü–∫–æ–π –ª–∏–Ω–∏–∏. –í—ã—Ö–æ–¥—ã –≤–µ–¥—É—Ç –∫ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π –∏ –∂–∏–ª—ã–º –∫–≤–∞—Ä—Ç–∞–ª–∞–º. –î–≤–∏–∂–µ–Ω–∏–µ –ø–æ–µ–∑–¥–æ–≤ –∑–∞–ø—É—â–µ–Ω–æ —Å —É—Ç—Ä–∞.',
                        images: []
                    },
                    {
                        id: 'msk2',
                        title: '–§–µ—Å—Ç–∏–≤–∞–ª—å "–ú–æ—Å–∫–æ–≤—Å–∫–æ–µ –ª–µ—Ç–æ" –Ω–∞ –¢–≤–µ—Ä—Å–∫–æ–π',
                        excerpt: '–ì–æ—Ä–æ–∂–∞–Ω –∂–¥—É—Ç –∫–æ–Ω—Ü–µ—Ä—Ç—ã, —è—Ä–º–∞—Ä–∫–∏ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.',
                        fullText: '–£–ª–∏—Ü—É –ø–µ—Ä–µ–∫—Ä—ã–ª–∏ –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞. –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä—ã –æ–±–µ—â–∞—é—Ç –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è —É–ª–∏—á–Ω—ã—Ö —Ç–µ–∞—Ç—Ä–æ–≤ –∏ –≥–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ä—è–¥—ã.',
                        images: []
                    },
                    {
                        id: 'msk3',
                        title: '–í –ø–∞—Ä–∫–µ –ó–∞—Ä—è–¥—å–µ —Ä–∞—Å—Ü–≤–µ–ª–∏ 3000 —Ç—é–ª—å–ø–∞–Ω–æ–≤',
                        excerpt: '–ù–µ–±—ã–≤–∞–ª–æ–µ —Ü–≤–µ—Ç–µ–Ω–∏–µ –∏–∑-–∑–∞ —Ä–∞–Ω–Ω–µ–π –≤–µ—Å–Ω—ã.',
                        fullText: '–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–∞—Ä–∫–∞ –ø—Ä–∏–≥–ª–∞—à–∞—é—Ç –º–æ—Å–∫–≤–∏—á–µ–π –Ω–∞ —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏. –õ–∞–Ω–¥—à–∞—Ñ—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω –æ–±–Ω–æ–≤–ª—ë–Ω.',
                        images: []
                    }
                ];
            }
        } catch (e) {}

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è)
        let isEditorMode = false;

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const newsContainer = document.getElementById('newsContainer');
        const detailView = document.getElementById('detailView');
        const detailContent = document.getElementById('detailContent');
        const backToListBtn = document.getElementById('backToList');

        const addNewsBtn = document.getElementById('addNewsBtn');
        const viewNewsBtn = document.getElementById('viewNewsBtn');
        const passwordModal = document.getElementById('passwordModal');
        const addModal = document.getElementById('addModal');
        const passwordInput = document.getElementById('passwordInput');
        const checkPasswordBtn = document.getElementById('checkPasswordBtn');
        const cancelPassword = document.getElementById('cancelPassword');
        const cancelAddModal = document.getElementById('cancelAddModal');
        const publishBtn = document.getElementById('publishNewsBtn');
        const passwordError = document.getElementById('passwordError');

        // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –º–æ–¥–∞–ª–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
        const deletePasswordModal = document.getElementById('deletePasswordModal');
        const deletePasswordInput = document.getElementById('deletePasswordInput');
        const checkDeletePasswordBtn = document.getElementById('checkDeletePasswordBtn');
        const cancelDeletePassword = document.getElementById('cancelDeletePassword');
        const deletePasswordError = document.getElementById('deletePasswordError');

        let pendingDeleteId = null; // ID –Ω–æ–≤–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—É—é –ø—ã—Ç–∞–µ–º—Å—è —É–¥–∞–ª–∏—Ç—å

        const titleInp = document.getElementById('newsTitle');
        const excerptInp = document.getElementById('newsExcerpt');
        const fullTextInp = document.getElementById('newsFullText');
        const photoListDiv = document.getElementById('photoList');
        const addPhotoBtn = document.getElementById('addPhotoBtn');

        let photoFields = [];

        function rebuildPhotoList() {
            if (!photoListDiv) return;
            photoListDiv.innerHTML = '';
            if (photoFields.length === 0) {
                photoListDiv.innerHTML = '<div style="background:#ecf5fc; border-radius:70px; padding:35px; text-align:center; font-size:1.4rem;">üìé –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)</div>';
                return;
            }
            for (let i = 0; i < photoFields.length; i++) {
                const div = document.createElement('div');
                div.className = 'photo-item';
                div.innerHTML = `
                    <input type="file" accept="image/*" id="photoFile_${i}">
                    <select id="photoPos_${i}">
                        <option value="top">üîù –Ω–∞–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º</option>
                        <option value="middle" selected>üìå –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ —Ç–µ–∫—Å—Ç–∞</option>
                        <option value="bottom">üîö –≤ –∫–æ–Ω—Ü–µ —Ç–µ–∫—Å—Ç–∞</option>
                    </select>
                    <button class="remove-photo" data-index="${i}">‚úñ</button>
                `;
                photoListDiv.appendChild(div);

                const fileInp = div.querySelector(`#photoFile_${i}`);
                const posSel = div.querySelector(`#photoPos_${i}`);
                photoFields[i] = { fileInput: fileInp, positionSelect: posSel };

                div.querySelector('.remove-photo').addEventListener('click', (e) => {
                    const idx = e.target.getAttribute('data-index');
                    photoFields.splice(idx, 1);
                    rebuildPhotoList();
                });
            }
        }

        addPhotoBtn.addEventListener('click', () => {
            if (photoFields.length >= 5) {
                alert('–ú–∞–∫—Å–∏–º—É–º 5 —Ñ–æ—Ç–æ');
                return;
            }
            photoFields.push({});
            rebuildPhotoList();
        });

        function resetPhotoFields() {
            photoFields = [];
            rebuildPhotoList();
        }

        // –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞)
        function deleteNews(newsId) {
            newsItems = newsItems.filter(item => item.id !== newsId);
            try {
                localStorage.setItem('moscow_city_news', JSON.stringify(newsItems));
            } catch(e) {}
            renderNewsList();
            if (detailView.classList.contains('show')) {
                backToList();
            }
        }

        function renderNewsList() {
            if (!newsContainer) return;
            if (newsItems.length === 0) {
                newsContainer.innerHTML = '<div class="empty-news">üèôÔ∏è –ü–æ–∫–∞ –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é!</div>';
                return;
            }

            let html = '';
            newsItems.forEach(item => {
                let coverImage = 'data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'500\' height=\'300\' viewBox=\'0 0 500 300\'%3E%3Crect width=\'500\' height=\'300\' fill=\'%23335f7e\'/%3E%3Ctext x=\'120\' y=\'170\' fill=\'%23ffffff\' font-size=\'70\' font-family=\'Inter\'%3EüèôÔ∏è%3C/text%3E%3C/svg%3E';
                if (item.images && item.images.length > 0 && item.images[0].data) {
                    coverImage = item.images[0].data;
                } else if (item.imageData) {
                    coverImage = item.imageData;
                }

                html += `
                    <div class="news-card" data-id="${item.id}">
                        <div class="delete-btn ${isEditorMode ? 'visible' : ''}" data-id="${item.id}" onclick="event.stopPropagation(); window.deleteClickHandler('${item.id}')">‚úñ</div>
                        <img class="card-img" src="${coverImage}" alt="" onerror="this.src='data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22500%22%20height%3D%22300%22%20viewBox%3D%220%200%20500%20300%22%3E%3Crect%20width%3D%22500%22%20height%3D%22300%22%20fill%3D%22%232f6183%22%2F%3E%3Ctext%20x%3D%22180%22%20y%3D%22180%22%20fill%3D%22%23ffffff%22%20font-size%3D%2290%22%3E%F0%9F%8C%83%3C%2Ftext%3E%3C%2Fsvg%3E')">
                        <div class="card-content">
                            <div class="card-title">${escapeHtml(item.title) || '–ú–æ—Å–∫–≤–∞'}</div>
                            <div class="card-excerpt">${escapeHtml(item.excerpt) || ''}</div>
                        </div>
                    </div>
                `;
            });
            newsContainer.innerHTML = html;

            document.querySelectorAll('.news-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    if (e.target.classList.contains('delete-btn')) return;
                    const id = this.getAttribute('data-id');
                    const news = newsItems.find(n => n.id === id);
                    if (news) showDetail(news);
                });
            });
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–ª–∏–∫–∞ –ø–æ —É–¥–∞–ª–µ–Ω–∏—é
        window.deleteClickHandler = function(id) {
            if (!isEditorMode) return;
            pendingDeleteId = id;
            deletePasswordModal.style.display = 'flex';
            deletePasswordInput.value = '';
            deletePasswordError.innerText = '';
        };

        function escapeHtml(unsafe) {
            if (!unsafe) return unsafe;
            return unsafe.replace(/[&<>"]/g, m => {
                if (m === '&') return '&amp;';
                if (m === '<') return '&lt;';
                if (m === '>') return '&gt;';
                if (m === '"') return '&quot;';
                return m;
            });
        }

        function showDetail(news) {
            let contentHtml = `<h2 class="detail-title">${escapeHtml(news.title)}</h2>`;

            if (news.images && news.images.length > 0) {
                const top = news.images.filter(i => i.position === 'top');
                top.forEach(i => { if (i.data) contentHtml += `<img src="${i.data}" class="inline-image image-position-top">`; });

                contentHtml += `<div class="detail-text-block">${escapeHtml(news.fullText) || ''}</div>`;

                const mid = news.images.filter(i => i.position === 'middle');
                mid.forEach(i => { if (i.data) contentHtml += `<img src="${i.data}" class="inline-image">`; });

                const bot = news.images.filter(i => i.position === 'bottom');
                bot.forEach(i => { if (i.data) contentHtml += `<img src="${i.data}" class="inline-image">`; });
            } else {
                contentHtml += `<div class="detail-text-block">${escapeHtml(news.fullText) || ''}</div>`;
                if (news.imageData) contentHtml += `<img src="${news.imageData}" class="inline-image">`;
            }

            detailContent.innerHTML = contentHtml;
            newsContainer.style.display = 'none';
            detailView.classList.add('show');
        }

        function backToList() {
            detailView.classList.remove('show');
            newsContainer.style.display = 'grid';
        }

        backToListBtn.addEventListener('click', backToList);

        function openPasswordModal() {
            passwordModal.style.display = 'flex';
            passwordInput.value = '';
            passwordError.innerText = '';
        }

        cancelPassword.addEventListener('click', () => passwordModal.style.display = 'none');
        
        checkPasswordBtn.addEventListener('click', () => {
            if (passwordInput.value.trim() === '8282') {
                passwordModal.style.display = 'none';
                addModal.style.display = 'flex';
                titleInp.value = '';
                excerptInp.value = '';
                fullTextInp.value = '';
                resetPhotoFields();
            } else {
                passwordError.innerText = '‚õî –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å';
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
        cancelDeletePassword.addEventListener('click', () => {
            deletePasswordModal.style.display = 'none';
            pendingDeleteId = null;
        });

        checkDeletePasswordBtn.addEventListener('click', () => {
            if (deletePasswordInput.value.trim() === '8282') {
                if (pendingDeleteId) {
                    deleteNews(pendingDeleteId);
                }
                deletePasswordModal.style.display = 'none';
                pendingDeleteId = null;
            } else {
                deletePasswordError.innerText = '‚õî –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å';
            }
        });

        // –í—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ (–¥–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ "–°–º–æ—Ç—Ä–µ—Ç—å –Ω–æ–≤–æ—Å—Ç–∏")
        let pressTimer;
        viewNewsBtn.addEventListener('mousedown', () => {
            pressTimer = setTimeout(() => {
                isEditorMode = !isEditorMode;
                renderNewsList();
                alert(isEditorMode ? 'üîì –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –≤–∫–ª—é—á–µ–Ω (–∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –≤–∏–¥–Ω—ã)' : 'üîí –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –≤—ã–∫–ª—é—á–µ–Ω');
            }, 1000);
        });
        viewNewsBtn.addEventListener('mouseup', () => clearTimeout(pressTimer));
        viewNewsBtn.addEventListener('mouseleave', () => clearTimeout(pressTimer));

        // –û–±—ã—á–Ω—ã–π –∫–ª–∏–∫ ‚Äî –ø—Ä–æ—Å—Ç–æ —Å–∫—Ä–æ–ª–ª
        viewNewsBtn.addEventListener('click', (e) => {
            if (detailView.classList.contains('show')) backToList();
            newsContainer.scrollIntoView({ behavior: 'smooth' });
        });

        cancelAddModal.addEventListener('click', () => addModal.style.display = 'none');
        addNewsBtn.addEventListener('click', openPasswordModal);

        publishBtn.addEventListener('click', async () => {
            const title = titleInp.value.trim();
            const excerpt = excerptInp.value.trim();
            const full = fullTextInp.value.trim();
            if (!title || !excerpt || !full) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç');
                return;
            }

            const images = [];
            for (let i = 0; i < photoFields.length; i++) {
                const field = photoFields[i];
                const file = field.fileInput?.files[0];
                if (file) {
                    const dataUrl = await readFileAsDataURL(file);
                    const pos = field.positionSelect?.value || 'middle';
                    images.push({ data: dataUrl, position: pos });
                }
            }

            const newNews = {
                id: 'msk_' + Date.now() + '_' + Math.random().toString(36).substr(2, 8),
                title,
                excerpt,
                fullText: full,
                images: images,
            };

            newsItems.unshift(newNews);
            try { localStorage.setItem('moscow_city_news', JSON.stringify(newsItems)); } catch(e) {}
            renderNewsList();
            if (detailView.classList.contains('show')) backToList();
            addModal.style.display = 'none';
        });

        function readFileAsDataURL(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.readAsDataURL(file);
            });
        }

        window.addEventListener('click', (e) => {
            if (e.target === passwordModal) passwordModal.style.display = 'none';
            if (e.target === addModal) addModal.style.display = 'none';
            if (e.target === deletePasswordModal) deletePasswordModal.style.display = 'none';
        });

        renderNewsList();
        window.addEventListener('load', () => {
            if (newsItems.length) localStorage.setItem('moscow_city_news', JSON.stringify(newsItems));
        });
    })();
</script>
</body>
</html>
