<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>–ù–æ–≤–æ—Å—Ç–∏ –ú–æ—Å–∫–≤–∞ ‚Ä¢ –ú–µ–≥–∞–ø–æ–ª–∏—Å</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: linear-gradient(145deg, #d9e6f2 0%, #f2f8ff 100%);
            min-height: 100vh;
            padding: 15px 12px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 30%, rgba(255, 220, 150, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 90% 70%, rgba(150, 200, 255, 0.2) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .app {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            border-radius: clamp(30px, 8vw, 70px);
            box-shadow: 0 25px 50px -20px #102b40, 0 0 0 2px rgba(255, 255, 255, 0.8) inset;
            padding: clamp(20px, 5vw, 50px);
            position: relative;
            z-index: 10;
            border: 1px solid rgba(255, 255, 255, 0.9);
        }

        .header {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            margin-bottom: clamp(25px, 4vw, 45px);
            background: rgba(255, 255, 255, 0.4);
            border-radius: 60px;
            padding: 12px 18px 12px 22px;
            box-shadow: 0 10px 25px -10px #1a3a52, 0 1px 0 0 rgba(255,255,255,0.8) inset;
            border: 1px solid rgba(255,255,255,0.8);
            gap: 12px;
        }

        .logo h1 {
            font-size: clamp(1.8rem, 6vw, 3rem);
            font-weight: 800;
            background: linear-gradient(145deg, #00263b, #1f5680);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.02em;
            display: flex;
            align-items: center;
            gap: 8px;
            line-height: 1.1;
        }

        .logo h1::after {
            content: '‚òÖ';
            font-size: clamp(1.8rem, 6vw, 3rem);
            -webkit-text-fill-color: #c9a03d;
            color: #c9a03d;
            text-shadow: 0 3px 6px #926d24;
        }

        .badge {
            background: #204967;
            color: white;
            padding: 6px 16px;
            border-radius: 40px;
            font-weight: 600;
            font-size: clamp(0.8rem, 2.5vw, 1.2rem);
            box-shadow: inset 0 -2px 0 #0e293f;
            border: 1px solid #8bb3d1;
            white-space: nowrap;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            width: 100%;
            justify-content: flex-end;
        }

        .btn {
            border: none;
            padding: 14px 22px;
            border-radius: 50px;
            font-weight: 700;
            font-size: clamp(1rem, 3.5vw, 1.3rem);
            background: rgba(255, 255, 255, 0.9);
            color: #021e30;
            backdrop-filter: blur(5px);
            box-shadow: 0 15px 25px -12px #021e32, 0 2px 0 0 white inset;
            cursor: pointer;
            transition: 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: 2px solid white;
            white-space: nowrap;
        }

        .btn-primary {
            background: #11314a;
            color: white;
            box-shadow: 0 20px 30px -12px #001b2d, 0 2px 0 0 #6c93b5 inset;
        }

        .btn-primary:hover {
            background: #1a405e;
            transform: scale(1.02) translateY(-2px);
        }

        .btn-outline:hover {
            background: white;
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(min(100%, 380px), 1fr));
            gap: 25px;
            margin: 30px 0 35px;
        }

        .news-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 40px;
            overflow: hidden;
            box-shadow: 0 20px 30px -15px #12314a, 0 0 0 2px rgba(255, 255, 255, 0.9) inset;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            border: 2px solid rgba(255, 255, 255, 0.9);
            position: relative;
        }

        .news-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 30px 40px -15px #03273f, 0 0 0 4px white inset;
            background: rgba(255, 255, 255, 0.95);
        }

        .delete-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: #c0392b;
            color: white;
            border: 3px solid white;
            font-size: 1.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 20;
            box-shadow: 0 4px 10px #3d1e1e;
            transition: 0.2s;
            line-height: 1;
            display: none;
        }

        .delete-btn:active {
            transform: scale(1.1);
            background: #e74c3c;
        }

        .delete-btn.visible {
            display: flex;
        }

        .card-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 4px solid white;
            pointer-events: none;
        }

        .card-content {
            padding: 20px 18px 18px;
            pointer-events: none;
        }

        .card-title {
            font-weight: 800;
            font-size: clamp(1.4rem, 5vw, 2rem);
            margin-bottom: 8px;
            color: #032a40;
            line-height: 1.2;
        }

        .card-excerpt {
            color: #1b4d6e;
            font-size: clamp(1rem, 3.5vw, 1.2rem);
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            font-weight: 500;
        }

        .detail-view {
            display: none;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            border-radius: clamp(30px, 6vw, 80px);
            padding: clamp(20px, 5vw, 60px);
            margin: 20px 0;
            box-shadow: 0 30px 50px -20px #00263b;
            border: 3px solid white;
        }

        .detail-view.show {
            display: block;
        }

        .detail-back {
            background: rgba(255, 255, 255, 0.8);
            border: 3px solid white;
            padding: 14px 28px;
            border-radius: 50px;
            font-weight: 700;
            color: #00263b;
            margin-bottom: 25px;
            cursor: pointer;
            font-size: clamp(1.2rem, 4vw, 1.4rem);
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 15px 25px -12px #021e32;
        }

        .detail-back:active {
            background: white;
            gap: 15px;
        }

        .detail-content {
            max-width: 1100px;
            margin: 0 auto;
        }

        .detail-title {
            font-size: clamp(2.2rem, 7vw, 4rem);
            font-weight: 800;
            color: #00263b;
            margin-bottom: 20px;
            background: linear-gradient(125deg, #002f4b, #216494);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.1;
        }

        .inline-image {
            max-width: 100%;
            border-radius: clamp(25px, 5vw, 60px);
            margin: 25px 0;
            box-shadow: 0 25px 35px -15px #032c44, 0 0 0 5px white, 0 0 0 7px #bed6ec;
            display: block;
        }

        .image-position-top {
            margin-top: 0;
            margin-bottom: 25px;
        }

        .image-position-middle {
            margin: 30px 0;
        }

        .image-position-bottom {
            margin-top: 25px;
            margin-bottom: 5px;
        }

        .detail-text-block {
            font-size: clamp(1.2rem, 4vw, 1.6rem);
            line-height: 1.6;
            color: #0e334b;
            white-space: pre-wrap;
            background: rgba(255, 255, 255, 0.7);
            border-radius: clamp(30px, 6vw, 70px);
            padding: clamp(25px, 5vw, 45px);
            backdrop-filter: blur(2px);
            border: 2px solid rgba(255, 255, 255, 0.9);
            margin: 25px 0;
            font-weight: 500;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(8px);
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 15px;
        }

        .modal-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(25px);
            max-width: 800px;
            width: 100%;
            padding: clamp(25px, 6vw, 55px);
            border-radius: clamp(40px, 8vw, 100px);
            box-shadow: 0 40px 70px -20px #021d33;
            border: 4px solid white;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-card h2 {
            font-size: clamp(1.8rem, 6vw, 2.8rem);
            color: #00263b;
            margin-bottom: 25px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            font-weight: 700;
            color: #14466b;
            margin-bottom: 6px;
            display: block;
            font-size: clamp(1.1rem, 3.5vw, 1.4rem);
        }

        .input-group input, .input-group textarea, .input-group select {
            width: 100%;
            padding: 16px 22px;
            border: 3px solid white;
            border-radius: 50px;
            font-size: 1rem;
            background: #ecf5fc;
            border: 3px solid #dae8f5;
            -webkit-appearance: none;
            appearance: none;
        }

        .input-group input:focus, .input-group textarea:focus {
            border-color: #2d7eb3;
            background: white;
            outline: none;
        }

        .photo-upload-panel {
            background: #deecf9;
            border-radius: 50px;
            padding: 20px;
            border: 3px dashed white;
            margin: 20px 0;
        }

        .photo-item {
            background: white;
            border-radius: 60px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }

        .photo-item input[type="file"] {
            flex: 2;
            min-width: 200px;
            padding: 12px;
            font-size: 0.9rem;
        }

        .photo-item select {
            flex: 1;
            min-width: 150px;
            padding: 12px;
            border-radius: 50px;
        }

        .remove-photo {
            background: #c0392b;
            color: white;
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            font-size: 1.8rem;
            cursor: pointer;
            flex-shrink: 0;
        }

        .add-photo-btn {
            background: #1f5680;
            color: white;
            border: none;
            padding: 16px 28px;
            border-radius: 60px;
            font-weight: 700;
            font-size: 1.2rem;
            cursor: pointer;
            border-bottom: 5px solid #0d314a;
            width: 100%;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .modal-actions button {
            flex: 1;
            min-width: 140px;
            padding: 16px;
            border-radius: 60px;
            font-weight: 700;
            font-size: 1.2rem;
            border: none;
            background: white;
            border-bottom: 5px solid #b3c9df;
            cursor: pointer;
        }

        .btn-publish {
            background: #03263b !important;
            color: white !important;
            border-bottom: 5px solid #153e5a !important;
        }

        .empty-news {
            text-align: center;
            padding: 50px 20px;
            background: #e1effa;
            border-radius: 60px;
            font-size: clamp(1.4rem, 5vw, 2rem);
            color: #01273f;
        }

        footer {
            margin-top: 40px;
            color: #1d3d57;
            text-align: center;
            font-size: clamp(1rem, 3.5vw, 1.3rem);
            font-weight: 500;
            background: rgba(255,255,255,0.4);
            padding: 20px;
            border-radius: 50px;
            border: 2px solid rgba(255,255,255,0.9);
        }

        .game-disclaimer {
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            font-weight: 800;
            color: #832828;
            background: rgba(255, 255, 255, 0.7);
            padding: 12px 18px;
            border-radius: 50px;
            margin-bottom: 20px;
            display: inline-block;
            backdrop-filter: blur(5px);
            border: 2px solid #ffbaba;
        }

        @media (max-width: 500px) {
            body { padding: 8px; }
            .header { flex-direction: column; align-items: stretch; }
            .action-buttons { justify-content: center; }
            .btn { padding: 12px 16px; font-size: 1rem; }
            .badge { align-self: flex-start; }
            .photo-item { flex-direction: column; }
            .photo-item input[type="file"], 
            .photo-item select { width: 100%; }
            .modal-actions button { min-width: 100%; }
        }

        @media (max-width: 380px) {
            .btn { padding: 10px 12px; font-size: 0.9rem; }
            .card-title { font-size: 1.3rem; }
        }
    </style>
</head>
<body>
<div class="app" id="app">
    <div class="header">
        <div class="logo">
            <h1>–ù–û–í–û–°–¢–ò –ú–û–°–ö–í–ê</h1>
            <span class="badge">#—Ü–µ–Ω—Ç—Ä —Å—Ç–æ–ª–∏—Ü—ã</span>
        </div>
        <div class="action-buttons">
            <button class="btn btn-outline" id="viewNewsBtn">üì∞ –°–º–æ—Ç—Ä–µ—Ç—å</button>
            <button class="btn btn-primary" id="addNewsBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <div id="newsContainer" class="news-grid"></div>

    <div id="detailView" class="detail-view">
        <button class="detail-back" id="backToList">‚Üê –∫–æ –≤—Å–µ–º</button>
        <div class="detail-content" id="detailContent"></div>
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∞ –ø–∞—Ä–æ–ª—è -->
    <div id="passwordModal" class="modal">
        <div class="modal-card">
            <h2>üîê –î–æ—Å—Ç—É–ø —Ä–µ–¥–∞–∫—Ü–∏–∏</h2>
            <div class="input-group">
                <label>–ü–∞—Ä–æ–ª—å</label>
                <input type="password" id="passwordInput" placeholder="‚óè‚óè‚óè‚óè">
            </div>
            <div class="modal-actions">
                <button id="cancelPassword">–û—Ç–º–µ–Ω–∞</button>
                <button id="checkPasswordBtn" class="btn-publish">–í–æ–π—Ç–∏</button>
            </div>
            <p id="passwordError" style="color:#b52e2e; margin-top:15px; font-size:1.2rem;"></p>
        </div>
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–∏ -->
    <div id="addModal" class="modal">
        <div class="modal-card">
            <h2>üìù –ù–æ–≤–∞—è –º–æ—Å–∫–æ–≤—Å–∫–∞—è –Ω–æ–≤–æ—Å—Ç—å</h2>
            <div class="input-group">
                <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
                <input type="text" id="newsTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ">
            </div>
            <div class="input-group">
                <label>–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</label>
                <textarea id="newsExcerpt" rows="2" placeholder="–ö–æ—Ä–æ—Ç–∫–æ –æ —Å–æ–±—ã—Ç–∏–∏..."></textarea>
            </div>
            <div class="input-group">
                <label>–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç</label>
                <textarea id="newsFullText" rows="3" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏..."></textarea>
            </div>

            <div class="photo-upload-panel">
                <label style="font-size:1.3rem; font-weight:700; margin-bottom:15px; display:block;">üì∏ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (–¥–æ 5)</label>
                <div id="photoList"></div>
                <button type="button" class="add-photo-btn" id="addPhotoBtn">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</button>
            </div>

            <div class="modal-actions">
                <button id="cancelAddModal">–û—Ç–º–µ–Ω–∞</button>
                <button id="publishNewsBtn" class="btn-publish">üì¢ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –º–æ–¥–∞–ª–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è -->
    <div id="deletePasswordModal" class="modal">
        <div class="modal-card">
            <h2>üîê –£–¥–∞–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h2>
            <div class="input-group">
                <label>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                <input type="password" id="deletePasswordInput" placeholder="‚óè‚óè‚óè‚óè">
            </div>
            <div class="modal-actions">
                <button id="cancelDeletePassword">–û—Ç–º–µ–Ω–∞</button>
                <button id="checkDeletePasswordBtn" class="btn-publish">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
            </div>
            <p id="deletePasswordError" style="color:#b52e2e; margin-top:15px;"></p>
        </div>
    </div>

    <footer>
        <div class="game-disclaimer">‚ö†Ô∏è –í–°–ï –ù–û–í–û–°–¢–ò –í–´–ú–´–®–õ–ï–ù–´ (–í–ò–î–ï–û–ò–ì–†–ê) ‚ö†Ô∏è</div>
        ¬© 2025 –ù–æ–≤–æ—Å—Ç–∏ –ú–æ—Å–∫–≤–∞ (–∏–≥—Ä–æ–≤–æ–π –ø—Ä–æ–µ–∫—Ç)
        <div style="margin-top: 20px; padding-top: 15px; border-top: 2px dashed rgba(255,255,255,0.5); display: flex; align-items: center; justify-content: center; gap: 12px; flex-wrap: wrap; font-size: 1rem;">
            <span style="display: flex; align-items: center; gap: 5px;">üïπÔ∏è <strong>–ù–µ –∏–≥—Ä–æ–≤–æ–π –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä</strong></span>
            <span style="color: #aaa;">|</span>
            <span style="display: flex; align-items: center; gap: 5px;">üéÆ <strong>–ß–∏—Å—Ç–æ –ø–æ –ø—Ä–∏–∫–æ–ª—É</strong></span>
            <span style="color: #aaa;">|</span>
            <span style="display: flex; align-items: center; gap: 5px;">üö´ <strong>–ù–∏–∫–∞–∫–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏</strong></span>
        </div>
    </footer>
</div>

<script>
(function() {
    // ================== –°–û–•–†–ê–ù–ï–ù–ò–ï –í –û–ù–õ–ê–ô–ù–ï ==================
    // –ö–õ–Æ–ß, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–æ–≤–æ—Å—Ç–∏
    const STORAGE_KEY = 'moscow_news_online';
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤–æ—Å—Ç–∏
    let newsItems = [];
    try {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
            newsItems = JSON.parse(saved);
        } else {
            // –°—Ç–∞—Ä—Ç–æ–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏, –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç
            newsItems = [
                { 
                    id: 'msk1', 
                    title: 'üöá –ù–æ–≤–∞—è —Å—Ç–∞–Ω—Ü–∏—è –º–µ—Ç—Ä–æ "–ù–∞–≥–∞—Ç–∏–Ω—Å–∫–∏–π –ó–∞—Ç–æ–Ω"', 
                    excerpt: '–í–∏—Ç—Ä–∞–∂–Ω—ã–µ –ø–æ—Ç–æ–ª–∫–∏ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ—Å—Ç–∏–±—é–ª–∏', 
                    fullText: '–°—Ç–∞–Ω—Ü–∏—è —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –Ω–∞ –ó–∞–º–æ—Å–∫–≤–æ—Ä–µ—Ü–∫–æ–π –ª–∏–Ω–∏–∏. –í—ã—Ö–æ–¥—ã –≤–µ–¥—É—Ç –∫ –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π –∏ –∂–∏–ª—ã–º –∫–≤–∞—Ä—Ç–∞–ª–∞–º.', 
                    images: [] 
                },
                { 
                    id: 'msk2', 
                    title: 'üé™ –§–µ—Å—Ç–∏–≤–∞–ª—å "–ú–æ—Å–∫–æ–≤—Å–∫–æ–µ –ª–µ—Ç–æ" –Ω–∞ –¢–≤–µ—Ä—Å–∫–æ–π', 
                    excerpt: '–ö–æ–Ω—Ü–µ—Ä—Ç—ã, —è—Ä–º–∞—Ä–∫–∏ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏', 
                    fullText: '–£–ª–∏—Ü—É –ø–µ—Ä–µ–∫—Ä—ã–ª–∏ –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞. –í—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è —É–ª–∏—á–Ω—ã—Ö —Ç–µ–∞—Ç—Ä–æ–≤ –∏ –≥–∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ä—è–¥—ã.', 
                    images: [] 
                },
                { 
                    id: 'msk3', 
                    title: 'üå∑ –í –ø–∞—Ä–∫–µ –ó–∞—Ä—è–¥—å–µ —Ä–∞—Å—Ü–≤–µ–ª–∏ 3000 —Ç—é–ª—å–ø–∞–Ω–æ–≤', 
                    excerpt: '–ù–µ–±—ã–≤–∞–ª–æ–µ —Ü–≤–µ—Ç–µ–Ω–∏–µ –∏–∑-–∑–∞ —Ä–∞–Ω–Ω–µ–π –≤–µ—Å–Ω—ã', 
                    fullText: '–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–∞—Ä–∫–∞ –ø—Ä–∏–≥–ª–∞—à–∞—é—Ç –º–æ—Å–∫–≤–∏—á–µ–π –Ω–∞ —Ñ–æ—Ç–æ—Å–µ—Å—Å–∏–∏.', 
                    images: [] 
                }
            ];
            localStorage.setItem(STORAGE_KEY, JSON.stringify(newsItems));
        }
    } catch (e) {
        newsItems = [];
    }

    // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ª—é–±–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è)
    function saveNews() {
        try {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(newsItems));
            console.log('–ù–æ–≤–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, –≤—Å–µ–≥–æ:', newsItems.length);
        } catch (e) {
            console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
        }
    }

    // ================== DOM –≠–õ–ï–ú–ï–ù–¢–´ ==================
    const newsContainer = document.getElementById('newsContainer');
    const detailView = document.getElementById('detailView');
    const detailContent = document.getElementById('detailContent');
    const backToListBtn = document.getElementById('backToList');
    const addNewsBtn = document.getElementById('addNewsBtn');
    const viewNewsBtn = document.getElementById('viewNewsBtn');
    const passwordModal = document.getElementById('passwordModal');
    const addModal = document.getElementById('addModal');
    const passwordInput = document.getElementById('passwordInput');
    const checkPasswordBtn = document.getElementById('checkPasswordBtn');
    const cancelPassword = document.getElementById('cancelPassword');
    const cancelAddModal = document.getElementById('cancelAddModal');
    const publishBtn = document.getElementById('publishNewsBtn');
    const passwordError = document.getElementById('passwordError');
    const deletePasswordModal = document.getElementById('deletePasswordModal');
    const deletePasswordInput = document.getElementById('deletePasswordInput');
    const checkDeletePasswordBtn = document.getElementById('checkDeletePasswordBtn');
    const cancelDeletePassword = document.getElementById('cancelDeletePassword');
    const deletePasswordError = document.getElementById('deletePasswordError');
    const titleInp = document.getElementById('newsTitle');
    const excerptInp = document.getElementById('newsExcerpt');
    const fullTextInp = document.getElementById('newsFullText');
    const photoListDiv = document.getElementById('photoList');
    const addPhotoBtn = document.getElementById('addPhotoBtn');

    // ================== –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==================
    let isEditorMode = false;
    let pendingDeleteId = null;
    let photoFields = [];

    // ================== –§–û–¢–û ==================
    function rebuildPhotoList() {
        if (!photoListDiv) return;
        photoListDiv.innerHTML = '';
        if (photoFields.length === 0) {
            photoListDiv.innerHTML = '<div style="background:#ecf5fc; border-radius:50px; padding:20px; text-align:center;">üìé –î–æ–±–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ</div>';
            return;
        }
        for (let i = 0; i < photoFields.length; i++) {
            const div = document.createElement('div');
            div.className = 'photo-item';
            div.innerHTML = `
                <input type="file" accept="image/*" id="photoFile_${i}">
                <select id="photoPos_${i}">
                    <option value="top">üîù –Ω–∞–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º</option>
                    <option value="middle" selected>üìå –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ</option>
                    <option value="bottom">üîö –≤ –∫–æ–Ω—Ü–µ</option>
                </select>
                <button class="remove-photo" data-index="${i}">‚úñ</button>
            `;
            photoListDiv.appendChild(div);
            const fileInp = div.querySelector(`#photoFile_${i}`);
            const posSel = div.querySelector(`#photoPos_${i}`);
            photoFields[i] = { fileInput: fileInp, positionSelect: posSel };
            div.querySelector('.remove-photo').onclick = (e) => {
                const idx = e.target.dataset.index;
                photoFields.splice(idx, 1);
                rebuildPhotoList();
            };
        }
    }

    addPhotoBtn.onclick = () => {
        if (photoFields.length >= 5) { alert('–ú–∞–∫—Å–∏–º—É–º 5 —Ñ–æ—Ç–æ'); return; }
        photoFields.push({});
        rebuildPhotoList();
    };

    function resetPhotoFields() { photoFields = []; rebuildPhotoList(); }

    // ================== –£–î–ê–õ–ï–ù–ò–ï ==================
    function deleteNews(newsId) {
        newsItems = newsItems.filter(item => item.id !== newsId);
        saveNews(); // –°–û–•–†–ê–ù–Ø–ï–ú
        renderNewsList();
        if (detailView.classList.contains('show')) backToList();
    }

    // ================== –≠–°–ö–ï–ô–ü ==================
    function escapeHtml(unsafe) {
        if (!unsafe) return unsafe;
        return unsafe.replace(/[&<>"]/g, m => {
            if (m === '&') return '&amp;';
            if (m === '<') return '&lt;';
            if (m === '>') return '&gt;';
            if (m === '"') return '&quot;';
            return m;
        });
    }

    // ================== –ü–û–ö–ê–ó –î–ï–¢–ê–õ–¨–ù–û ==================
    function showDetail(news) {
        let html = `<h2 class="detail-title">${escapeHtml(news.title)}</h2>`;
        if (news.images && news.images.length) {
            news.images.filter(i => i.position === 'top').forEach(i => { if (i.data) html += `<img src="${i.data}" class="inline-image">`; });
            html += `<div class="detail-text-block">${escapeHtml(news.fullText) || ''}</div>`;
            news.images.filter(i => i.position === 'middle').forEach(i => { if (i.data) html += `<img src="${i.data}" class="inline-image">`; });
            news.images.filter(i => i.position === 'bottom').forEach(i => { if (i.data) html += `<img src="${i.data}" class="inline-image">`; });
        } else {
            html += `<div class="detail-text-block">${escapeHtml(news.fullText) || ''}</div>`;
            if (news.imageData) html += `<img src="${news.imageData}" class="inline-image">`;
        }
        detailContent.innerHTML = html;
        newsContainer.style.display = 'none';
        detailView.classList.add('show');
    }

    function backToList() {
        detailView.classList.remove('show');
        newsContainer.style.display = 'grid';
    }

    // ================== –†–ï–ù–î–ï–† –°–ü–ò–°–ö–ê ==================
    function renderNewsList() {
        if (!newsContainer) return;
        if (newsItems.length === 0) {
            newsContainer.innerHTML = '<div class="empty-news">üèôÔ∏è –ü–æ–∫–∞ –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é!</div>';
            return;
        }
        let html = '';
        newsItems.forEach(item => {
            let cover = 'data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'400\' height=\'200\'%3E%3Crect width=\'400\' height=\'200\' fill=\'%23335f7e\'/%3E%3Ctext x=\'120\' y=\'120\' fill=\'%23fff\' font-size=\'60\'%3EüèôÔ∏è%3C/text%3E%3C/svg%3E';
            if (item.images?.length && item.images[0].data) cover = item.images[0].data;
            html += `<div class="news-card" data-id="${item.id}">
                <div class="delete-btn ${isEditorMode ? 'visible' : ''}" data-id="${item.id}" onclick="event.stopPropagation(); window.dch('${item.id}')">‚úñ</div>
                <img class="card-img" src="${cover}" onerror="this.src='${cover}'">
                <div class="card-content">
                    <div class="card-title">${escapeHtml(item.title) || ''}</div>
                    <div class="card-excerpt">${escapeHtml(item.excerpt) || ''}</div>
                </div>
            </div>`;
        });
        newsContainer.innerHTML = html;
        document.querySelectorAll('.news-card').forEach(card => {
            card.onclick = function(e) {
                if (e.target.classList.contains('delete-btn')) return;
                const id = this.dataset.id;
                const news = newsItems.find(n => n.id === id);
                if (news) showDetail(news);
            };
        });
    }

    // ================== –ì–õ–û–ë–ê–õ–¨–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö –£–î–ê–õ–ï–ù–ò–Ø ==================
    window.dch = (id) => {
        if (!isEditorMode) return;
        pendingDeleteId = id;
        deletePasswordModal.style.display = 'flex';
        deletePasswordInput.value = '';
        deletePasswordError.innerText = '';
    };

    // ================== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ==================
    backToListBtn.onclick = backToList;

    cancelPassword.onclick = () => passwordModal.style.display = 'none';
    checkPasswordBtn.onclick = () => {
        if (passwordInput.value.trim() === '8282') {
            passwordModal.style.display = 'none';
            addModal.style.display = 'flex';
            titleInp.value = ''; excerptInp.value = ''; fullTextInp.value = '';
            resetPhotoFields();
        } else { passwordError.innerText = '‚õî –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å'; }
    };

    cancelDeletePassword.onclick = () => { deletePasswordModal.style.display = 'none'; pendingDeleteId = null; };
    checkDeletePasswordBtn.onclick = () => {
        if (deletePasswordInput.value.trim() === '8282') {
            if (pendingDeleteId) deleteNews(pendingDeleteId);
            deletePasswordModal.style.display = 'none';
            pendingDeleteId = null;
        } else { deletePasswordError.innerText = '‚õî –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å'; }
    };

    // –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –¥–ª—è —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
    let pressTimer;
    viewNewsBtn.addEventListener('mousedown', () => {
        pressTimer = setTimeout(() => {
            isEditorMode = !isEditorMode;
            renderNewsList();
            alert(isEditorMode ? 'üîì –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞' : 'üîí –†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞');
        }, 800);
    });
    viewNewsBtn.addEventListener('mouseup', () => clearTimeout(pressTimer));
    viewNewsBtn.addEventListener('mouseleave', () => clearTimeout(pressTimer));
    viewNewsBtn.addEventListener('touchstart', (e) => {
        pressTimer = setTimeout(() => {
            isEditorMode = !isEditorMode;
            renderNewsList();
            alert(isEditorMode ? 'üîì –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞' : 'üîí –†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞');
        }, 800);
    });
    viewNewsBtn.addEventListener('touchend', () => clearTimeout(pressTimer));
    viewNewsBtn.addEventListener('touchcancel', () => clearTimeout(pressTimer));
    
    viewNewsBtn.addEventListener('click', (e) => {
        if (detailView.classList.contains('show')) backToList();
        newsContainer.scrollIntoView({ behavior: 'smooth' });
    });

    cancelAddModal.onclick = () => addModal.style.display = 'none';
    addNewsBtn.onclick = () => {
        passwordModal.style.display = 'flex';
        passwordInput.value = '';
        passwordError.innerText = '';
    };

    // ================== –ü–£–ë–õ–ò–ö–ê–¶–ò–Ø –ù–û–í–û–°–¢–ò ==================
    publishBtn.onclick = async () => {
        const title = titleInp.value.trim();
        const excerpt = excerptInp.value.trim();
        const full = fullTextInp.value.trim();
        if (!title || !excerpt || !full) { alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è'); return; }
        const images = [];
        for (let i = 0; i < photoFields.length; i++) {
            const f = photoFields[i];
            const file = f.fileInput?.files[0];
            if (file) {
                const dataUrl = await new Promise(r => { const rd = new FileReader(); rd.onload = () => r(rd.result); rd.readAsDataURL(file); });
                images.push({ data: dataUrl, position: f.positionSelect?.value || 'middle' });
            }
        }
        const newNews = { 
            id: 'msk_' + Date.now() + '_' + Math.random().toString(36).substr(2, 6), 
            title, 
            excerpt, 
            fullText: full, 
            images 
        };
        newsItems.unshift(newNews);
        saveNews(); // ‚Üê –°–û–•–†–ê–ù–Ø–ï–ú –í LOCALSTORAGE
        renderNewsList();
        if (detailView.classList.contains('show')) backToList();
        addModal.style.display = 'none';
    };

    // ================== –ó–ê–ö–†–´–¢–ò–ï –ú–û–î–ê–õ–û–ö ==================
    window.onclick = (e) => {
        if (e.target === passwordModal) passwordModal.style.display = 'none';
        if (e.target === addModal) addModal.style.display = 'none';
        if (e.target === deletePasswordModal) deletePasswordModal.style.display = 'none';
    };

    // ================== –°–¢–ê–†–¢ ==================
    renderNewsList();
    
    // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤–æ—Å—Ç–µ–π –≤ –∫–æ–Ω—Å–æ–ª–∏
    console.log('–ó–∞–≥—Ä—É–∂–µ–Ω–æ –Ω–æ–≤–æ—Å—Ç–µ–π:', newsItems.length);
})();
</script>
</body>
</html>
